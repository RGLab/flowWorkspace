<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>flowWorkspace Introduction: A Package to store and maninpulate gated flow data • flowWorkspace</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="flowWorkspace Introduction: A Package to store and maninpulate gated flow data">
<meta property="og:description" content="flowWorkspace">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">flowWorkspace</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">4.3.4</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/index.html">Articles</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/RGLab/flowWorkspace">
    <span class="fas fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="flowWorkspace-Introduction_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>flowWorkspace Introduction: A Package to store and maninpulate gated flow data</h1>
                        <h4 class="author">Greg Finak <a href="mailto:greg@ozette.ai" class="email">greg@ozette.ai</a>, Mike Jiang <a href="mailto:mike@ozette.ai" class="email">mike@ozette.ai</a>
</h4>
            
      
      
      <div class="hidden name"><code>flowWorkspace-Introduction.Rmd</code></div>

    </div>

    
    
<div id="purpose" class="section level2">
<h2 class="hasAnchor">
<a href="#purpose" class="anchor"></a>Purpose</h2>
<p>The purpose of this package is to provide the infrastructure to store, represent and exchange gated flow data. By this we mean accessing the samples, groups, transformations, compensation matrices, gates, and population statistics in the gating tree, which is represented as a <code>GatingSet</code> object in <code>R</code>.</p>
<p>There are several ways to generate a <code>GatingSet</code>: * built from scratch within <code>R</code> (which will be demonstrated later) * imported from the XML workspace files exported from other software (e.g. FlowJo, Diva, CytoBank). Details on the importing xml are documented in <a href="https://www.bioconductor.org/packages/release/bioc/html/CytoML.html">CytoML</a> package. * generated by automated gating framework from <a href="https://www.bioconductor.org/packages/release/bioc/html/openCyto.html">openCyto</a> package * loaded from the existing GatingSet archive (that was previously saved by <code><a href="../reference/save_gs.html">save_gs()</a></code> call)</p>
<p>Here we simply load an example <code>GatingSet</code> archive to illustrate how to interact with a <code>GatingSet</code> object.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">flowWorkspace</span><span class="op">)</span>
<span class="va">dataDir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>,package<span class="op">=</span><span class="st">"flowWorkspaceData"</span><span class="op">)</span>
<span class="va">gs_archive</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html">list.files</a></span><span class="op">(</span><span class="va">dataDir</span>, pattern <span class="op">=</span> <span class="st">"gs_bcell_auto"</span>,full <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="va">gs</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/save_gs.html">load_gs</a></span><span class="op">(</span><span class="va">gs_archive</span><span class="op">)</span>
<span class="va">gs</span></code></pre></div>
<pre><code>## A GatingSet with 2 samples</code></pre>
<p>We have loaded a <code>GatingSet</code> with 2 samples, each of which has 14 associated gates.</p>
<p>To list the samples stored in <code>GatingSet</code>:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/sampleNames.html">sampleNames</a></span><span class="op">(</span><span class="va">gs</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "12828_1_Bcell_C01.fcs" "12828_2_Bcell_C02.fcs"</code></pre>
</div>
<div id="basics-on-gatingset" class="section level2">
<h2 class="hasAnchor">
<a href="#basics-on-gatingset" class="anchor"></a>Basics on GatingSet</h2>
<p>Subsets of a <code>GatingSet</code> can be accessed using the standard R subset syntax <code><a href="../reference/%5B,GatingSet,ANY,ANY,ANY-method.html">[</a></code>.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">gs</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></code></pre></div>
<pre><code>## A GatingSet with 1 samples</code></pre>
<p>We can plot the gating tree:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plot-methods.html">plot</a></span><span class="op">(</span><span class="va">gs</span>, bool <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<p><img src="flowWorkspace-Introduction_files/figure-html/plotTree-1.png" width="700"> The boolean gates(notes) are highlighted in blue color.</p>
<p>We can list the nodes (populations) in the gating hierarchy:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/gs_get_pop_paths.html">gs_get_pop_paths</a></span><span class="op">(</span><span class="va">gs</span>, path <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></code></pre></div>
<pre><code>##  [1] "root"                      "boundary/nonDebris"       
##  [3] "nonDebris/lymph"           "lymph/Live"               
##  [5] "Live/CD20"                 "Live/CD19"                
##  [7] "Live/CD19andCD20"          "CD19andCD20/IgD-CD27-"    
##  [9] "CD19andCD20/IgD+CD27-"     "CD19andCD20/IgD-CD27+"    
## [11] "CD19andCD20/IgD+CD27+"     "CD19andCD20/Transitional" 
## [13] "Live/CD19and!CD20"         "CD19and!CD20/Plasmablasts"
## [15] "Live/CD3"</code></pre>
<p>Note that the <code>path</code> argument specifies the depth of the gating path for each population. As shown, <code>depth</code> of <code>1</code> (i.e. leaf or terminal node name) may not be sufficient to uniquely identify each population. The issue can be resolved by increasing the <code>path</code> or simply returning the full path of the node:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/gs_get_pop_paths.html">gs_get_pop_paths</a></span><span class="op">(</span><span class="va">gs</span>, path <span class="op">=</span> <span class="st">"full"</span><span class="op">)</span></code></pre></div>
<pre><code>##  [1] "root"                                                    
##  [2] "/boundary/nonDebris"                                     
##  [3] "/boundary/nonDebris/lymph"                               
##  [4] "/boundary/nonDebris/lymph/Live"                          
##  [5] "/boundary/nonDebris/lymph/Live/CD20"                     
##  [6] "/boundary/nonDebris/lymph/Live/CD19"                     
##  [7] "/boundary/nonDebris/lymph/Live/CD19andCD20"              
##  [8] "/boundary/nonDebris/lymph/Live/CD19andCD20/IgD-CD27-"    
##  [9] "/boundary/nonDebris/lymph/Live/CD19andCD20/IgD+CD27-"    
## [10] "/boundary/nonDebris/lymph/Live/CD19andCD20/IgD-CD27+"    
## [11] "/boundary/nonDebris/lymph/Live/CD19andCD20/IgD+CD27+"    
## [12] "/boundary/nonDebris/lymph/Live/CD19andCD20/Transitional" 
## [13] "/boundary/nonDebris/lymph/Live/CD19and!CD20"             
## [14] "/boundary/nonDebris/lymph/Live/CD19and!CD20/Plasmablasts"
## [15] "/boundary/nonDebris/lymph/Live/CD3"</code></pre>
<p>But <code>full</code> path may not be necessary and could be too long to be visualized. So we provide the <code>path = 'auto'</code> option to determine the shortest path that is still unique within the gating tree.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">nodelist</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gs_get_pop_paths.html">gs_get_pop_paths</a></span><span class="op">(</span><span class="va">gs</span>, path <span class="op">=</span> <span class="st">"auto"</span><span class="op">)</span>
<span class="va">nodelist</span></code></pre></div>
<pre><code>##  [1] "root"         "nonDebris"    "lymph"        "Live"         "CD20"        
##  [6] "CD19"         "CD19andCD20"  "IgD-CD27-"    "IgD+CD27-"    "IgD-CD27+"   
## [11] "IgD+CD27+"    "Transitional" "CD19and!CD20" "Plasmablasts" "CD3"</code></pre>
<p>We can get the gate associated with the specific population:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">node</span> <span class="op">&lt;-</span> <span class="va">nodelist</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>
<span class="va">g</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gs_pop_get_gate.html">gs_pop_get_gate</a></span><span class="op">(</span><span class="va">gs</span>, <span class="va">node</span><span class="op">)</span>
<span class="va">g</span></code></pre></div>
<pre><code>## $`12828_1_Bcell_C01.fcs`
## Ellipsoid gate 'lymph' in dimensions FSC-A and SSC-A
## 
## $`12828_2_Bcell_C02.fcs`
## Ellipsoid gate 'lymph' in dimensions FSC-A and SSC-A</code></pre>
<p>We can retrieve the population statistics :</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/gs_pop_get_stats.html">gs_pop_get_stats</a></span><span class="op">(</span><span class="va">gs</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>,<span class="op">]</span></code></pre></div>
<pre><code>##                    sample                                                  pop
##  1: 12828_1_Bcell_C01.fcs                                                 root
##  2: 12828_1_Bcell_C01.fcs                                  /boundary/nonDebris
##  3: 12828_1_Bcell_C01.fcs                            /boundary/nonDebris/lymph
##  4: 12828_1_Bcell_C01.fcs                       /boundary/nonDebris/lymph/Live
##  5: 12828_1_Bcell_C01.fcs                  /boundary/nonDebris/lymph/Live/CD20
##  6: 12828_1_Bcell_C01.fcs                  /boundary/nonDebris/lymph/Live/CD19
##  7: 12828_1_Bcell_C01.fcs           /boundary/nonDebris/lymph/Live/CD19andCD20
##  8: 12828_1_Bcell_C01.fcs /boundary/nonDebris/lymph/Live/CD19andCD20/IgD-CD27-
##  9: 12828_1_Bcell_C01.fcs /boundary/nonDebris/lymph/Live/CD19andCD20/IgD+CD27-
## 10: 12828_1_Bcell_C01.fcs /boundary/nonDebris/lymph/Live/CD19andCD20/IgD-CD27+
##     count
##  1: 81638
##  2: 80711
##  3: 52927
##  4: 51652
##  5: 11093
##  6: 11126
##  7: 11028
##  8:   765
##  9:  9219
## 10:   590</code></pre>
<p>We can plot individual gates. Note the scale of the transformed axes. The second argument is the node path of any depth as long as it is uniquely identifiable.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/RGLab/ggcyto/issues">ggcyto</a></span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/ggcyto/man/autoplot.html">autoplot</a></span><span class="op">(</span><span class="va">gs</span>, <span class="va">node</span><span class="op">)</span></code></pre></div>
<p><img src="flowWorkspace-Introduction_files/figure-html/autoplot-nodeName-1.png" width="700"> More details about gate visualization can be found <a href="http://bioconductor.org/packages/release/bioc/html/ggcyto.html">here</a>.</p>
<p>If we have metadata associated with the experiment, it can be attached to the <code>GatingSet</code>.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>sample<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"sample 1"</span>, <span class="st">"sample 2"</span><span class="op">)</span><span class="op">)</span>,treatment<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"sample"</span>,<span class="st">"control"</span><span class="op">)</span><span class="op">)</span> <span class="op">)</span>
<span class="va">pd</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pData-methods.html">pData</a></span><span class="op">(</span><span class="va">gs</span><span class="op">)</span>
<span class="va">pd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">pd</span>,<span class="va">d</span><span class="op">)</span>
<span class="fu"><a href="../reference/pData-methods.html">pData</a></span><span class="op">(</span><span class="va">gs</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">pd</span>
<span class="fu"><a href="../reference/pData-methods.html">pData</a></span><span class="op">(</span><span class="va">gs</span><span class="op">)</span></code></pre></div>
<pre><code>##                       Replicate                  name Sample Center   sample
## 12828_1_Bcell_C01.fcs         1 12828_1_Bcell_C01.fcs  12828  NHLBI sample 1
## 12828_2_Bcell_C02.fcs         2 12828_2_Bcell_C02.fcs  12828  NHLBI sample 2
##                       treatment
## 12828_1_Bcell_C01.fcs    sample
## 12828_2_Bcell_C02.fcs   control</code></pre>
<p>We can subset the <code>GatingSet</code> by its <code>pData</code> directly:</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/subset.html">subset</a></span><span class="op">(</span><span class="va">gs</span>, <span class="va">treatment</span> <span class="op">==</span> <span class="st">"control"</span><span class="op">)</span></code></pre></div>
<pre><code>## A GatingSet with 1 samples</code></pre>
<p>The underlying <code>flow data</code> can be retrieved by:</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">cs</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gh_pop_get_data.html">gs_pop_get_data</a></span><span class="op">(</span><span class="va">gs</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span><span class="op">(</span><span class="va">cs</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "cytoset"
## attr(,"package")
## [1] "flowWorkspace"</code></pre>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">cs</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 81638</code></pre>
<p>Because <code>GatingSet</code> is a purely reference class, the class type returned by <code>gs_pop_get_data</code> is a <code>cytoset</code>, which is the purely reference class analog of a <code>flowSet</code> and will be discussed in more detail below. Also note that the data is already compensated and transformed during the parsing.</p>
<p>We can retrieve the subset of data associated with a population node:</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">cs</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gh_pop_get_data.html">gs_pop_get_data</a></span><span class="op">(</span><span class="va">gs</span>, <span class="va">node</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">cs</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 52927</code></pre>
</div>
<div id="gatinghierarchy" class="section level2">
<h2 class="hasAnchor">
<a href="#gatinghierarchy" class="anchor"></a>GatingHierarchy</h2>
<p>We can retrieve a single gating hierarchical tree (corresponding to one sample) by using the <code><a href="../reference/%5B,GatingSet,ANY,ANY,ANY-method.html">[[</a></code> extraction operator</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">gh</span> <span class="op">&lt;-</span> <span class="va">gs</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>
<span class="va">gh</span></code></pre></div>
<pre><code>## Sample:  12828_1_Bcell_C01.fcs 
## GatingHierarchy with  15  gates</code></pre>
<p>Note that the index can be either numeric or character (the <code>guid</code> returned by the <code>sampleNames</code> method)</p>
<p>The <code>autoplot</code> method without specifying any node will lay out all the gates in the same plot</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/ggcyto/man/autoplot.html">autoplot</a></span><span class="op">(</span><span class="va">gh</span><span class="op">)</span></code></pre></div>
<p><img src="flowWorkspace-Introduction_files/figure-html/unnamed-chunk-3-1.png" width="700"></p>
<p>We can retrieve the indices specifying if an event is included inside or outside a gate using:</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="fu"><a href="../reference/gh_pop_get_indices.html">gh_pop_get_indices</a></span><span class="op">(</span><span class="va">gh</span>,<span class="va">node</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## 
## FALSE  TRUE 
## 28711 52927</code></pre>
<p>The indices returned are relative to the parent population (member of parent AND member of current gate), so they reflect the true hierarchical gating structure.</p>
</div>
<div id="build-the-gatingset-from-scratch" class="section level2">
<h2 class="hasAnchor">
<a href="#build-the-gatingset-from-scratch" class="anchor"></a>Build the GatingSet from scratch</h2>
<p><code>GatingSet</code> provides methods to build a gating tree from raw FCS files and add or remove flowCore gates (or populations) to or from it.</p>
<p>We start from a <code>flowSet</code> that contains three ungated flow samples:</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">flowCore</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">GvHD</span><span class="op">)</span>
<span class="co">#select raw flow data</span>
<span class="va">fs</span> <span class="op">&lt;-</span> <span class="va">GvHD</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span></code></pre></div>
<p>Then construct a <code>GatingSet</code> from the <code>flowSet</code>:</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">gs</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/GatingSet-class.html">GatingSet</a></span><span class="op">(</span><span class="va">fs</span><span class="op">)</span></code></pre></div>
<p>Then compensate it:</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">cfile</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>,<span class="st">"compdata"</span>,<span class="st">"compmatrix"</span>, package<span class="op">=</span><span class="st">"flowCore"</span><span class="op">)</span>
<span class="va">comp.mat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.table</a></span><span class="op">(</span><span class="va">cfile</span>, header<span class="op">=</span><span class="cn">TRUE</span>, skip<span class="op">=</span><span class="fl">2</span>, check.names <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="co">## create a compensation object </span>
<span class="va">comp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/flowCore/man/compensation-class.html">compensation</a></span><span class="op">(</span><span class="va">comp.mat</span><span class="op">)</span>
<span class="co">#compensate GatingSet</span>
<span class="va">gs</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/compensate.html">compensate</a></span><span class="op">(</span><span class="va">gs</span>, <span class="va">comp</span><span class="op">)</span></code></pre></div>
<p><span style="color:red"><strong>New</strong>: You can now pass a list of <code>compensation</code> objects with elements named by <code><a href="../reference/sampleNames.html">sampleNames(gs)</a></code> to achieve sample-specific compensations. e.g. </span></p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">gs</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/compensate.html">compensate</a></span><span class="op">(</span><span class="va">gs</span>, <span class="va">comp.list</span><span class="op">)</span></code></pre></div>
<p>Then we can transform it with any transformation defined by the user through <code>trans_new</code> function of <code>scales</code> package.</p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">require</a></span><span class="op">(</span><span class="va"><a href="https://scales.r-lib.org">scales</a></span><span class="op">)</span>
<span class="va">trans.func</span> <span class="op">&lt;-</span> <span class="va">asinh</span>
<span class="va">inv.func</span> <span class="op">&lt;-</span> <span class="va">sinh</span>
<span class="va">trans.obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://scales.r-lib.org//reference/trans_new.html">trans_new</a></span><span class="op">(</span><span class="st">"myAsinh"</span>, <span class="va">trans.func</span>, <span class="va">inv.func</span><span class="op">)</span></code></pre></div>
<p>The <code>inverse</code> transformation is required so that the gates and data can be visualized in <code>transformed</code> scale while the axis label still remains in the raw scale. Optionally, the <code>breaks</code> and <code>format</code> functions can be supplied to further customize the appearance of axis labels.</p>
<p>Besides doing all these by hand, we also provide some buildin transformations: <code>asinhtGml2_trans</code>, <code>flowjo_biexp_trans</code>, <code>flowjo_fasinh_trans</code> and <code>logicle_trans</code>. These are all very commonly used transformations in flow data analysis. User can construct the transform object by simply one-line of code. e.g.</p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">trans.obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/asinhtGml2_trans.html">asinhtGml2_trans</a></span><span class="op">(</span><span class="op">)</span>
<span class="va">trans.obj</span></code></pre></div>
<pre><code>## Transformer:  asinhtGml2</code></pre>
<p>Once a <code>transformer</code> object is created, we must convert it to <code>transformerList</code> for <code>GatingSet</code> to use.</p>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">chnls</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">fs</span><span class="op">)</span><span class="op">[</span><span class="fl">3</span><span class="op">:</span><span class="fl">6</span><span class="op">]</span> 
<span class="va">transList</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/transformerList.html">transformerList</a></span><span class="op">(</span><span class="va">chnls</span>, <span class="va">trans.obj</span><span class="op">)</span></code></pre></div>
<p>Alternatively, the overloaded <code>estimateLogicle</code> method can be used directly on <code>GatingHierarchy</code> to generate a <code>transformerList</code> object automatically.</p>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/estimateLogicle.html">estimateLogicle</a></span><span class="op">(</span><span class="va">gs</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, <span class="va">chnls</span><span class="op">)</span></code></pre></div>
<pre><code>## $`FL1-H`
## Transformer:  logicle 
## 
## $`FL2-H`
## Transformer:  logicle 
## 
## $`FL3-H`
## Transformer:  logicle 
## 
## $`FL2-A`
## Transformer:  logicle 
## 
## attr(,"class")
## [1] "transformerList" "list"</code></pre>
<p>Now we can transform our <code>GatingSet</code> with this <code>transformerList</code> object. It will also store the transformation in the <code>GatingSet</code> and can be used to inverse-transform the data.</p>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">gs</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/transform.html">transform</a></span><span class="op">(</span><span class="va">gs</span>, <span class="va">transList</span><span class="op">)</span>
<span class="fu"><a href="../reference/gs_get_pop_paths.html">gs_get_pop_paths</a></span><span class="op">(</span><span class="va">gs</span><span class="op">)</span> </code></pre></div>
<pre><code>## [1] "root"</code></pre>
<p>It now only contains the root node. We can add our first <code>rectangleGate</code>:</p>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">rg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/flowCore/man/rectangleGate-class.html">rectangleGate</a></span><span class="op">(</span><span class="st">"FSC-H"</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">200</span>,<span class="fl">400</span><span class="op">)</span>, <span class="st">"SSC-H"</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">250</span>, <span class="fl">400</span><span class="op">)</span>, filterId<span class="op">=</span><span class="st">"rectangle"</span><span class="op">)</span>
<span class="va">nodeID</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gs_pop_add.html">gs_pop_add</a></span><span class="op">(</span><span class="va">gs</span>, <span class="va">rg</span><span class="op">)</span>
<span class="va">nodeID</span></code></pre></div>
<pre><code>## [1] 2</code></pre>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/gs_get_pop_paths.html">gs_get_pop_paths</a></span><span class="op">(</span><span class="va">gs</span><span class="op">)</span>  </code></pre></div>
<pre><code>## [1] "root"       "/rectangle"</code></pre>
<p>Note that the gate is added to the root node by default if the parent is not specified. Then we add a <code>quadGate</code> to the new population generated by the <code>rectangleGate</code> which is named after the <code>filterId</code> of the gate because the name was not specified when the <code>add</code> method was called.</p>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">qg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/flowCore/man/quadGate-class.html">quadGate</a></span><span class="op">(</span><span class="st">"FL1-H"</span><span class="op">=</span> <span class="fl">0.2</span>, <span class="st">"FL2-H"</span><span class="op">=</span> <span class="fl">0.4</span><span class="op">)</span>
<span class="va">nodeIDs</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gs_pop_add.html">gs_pop_add</a></span><span class="op">(</span><span class="va">gs</span>,<span class="va">qg</span>,parent<span class="op">=</span><span class="st">"rectangle"</span><span class="op">)</span>
<span class="va">nodeIDs</span> </code></pre></div>
<pre><code>## [1] 3 4 5 6</code></pre>
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/gs_get_pop_paths.html">gs_get_pop_paths</a></span><span class="op">(</span><span class="va">gs</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "root"                          "/rectangle"                   
## [3] "/rectangle/CD15 FITC-CD45 PE+" "/rectangle/CD15 FITC+CD45 PE+"
## [5] "/rectangle/CD15 FITC+CD45 PE-" "/rectangle/CD15 FITC-CD45 PE-"</code></pre>
<p>Here <code>quadGate</code> produces four population nodes/populations named after the dimensions of the gate if names are not specified.</p>
<p>A Boolean gate can also be defined and added to GatingSet:</p>
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">bg</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/booleanFilter-class.html">booleanFilter</a></span><span class="op">(</span><span class="va">`CD15 FITC-CD45 PE+|CD15 FITC+CD45 PE-`</span><span class="op">)</span>
<span class="va">bg</span></code></pre></div>
<pre><code>## booleanFilter filter 'CD15 FITC-CD45 PE+|CD15 FITC+CD45 PE-' evaluating the expression:
## CD15 FITC-CD45 PE+|CD15 FITC+CD45 PE-</code></pre>
<div class="sourceCode" id="cb56"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">nodeID2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gs_pop_add.html">gs_pop_add</a></span><span class="op">(</span><span class="va">gs</span>,<span class="va">bg</span>,parent<span class="op">=</span><span class="st">"rectangle"</span><span class="op">)</span>
<span class="va">nodeID2</span></code></pre></div>
<pre><code>## [1] 7</code></pre>
<div class="sourceCode" id="cb58"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/gs_get_pop_paths.html">gs_get_pop_paths</a></span><span class="op">(</span><span class="va">gs</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "root"                                            
## [2] "/rectangle"                                      
## [3] "/rectangle/CD15 FITC-CD45 PE+"                   
## [4] "/rectangle/CD15 FITC+CD45 PE+"                   
## [5] "/rectangle/CD15 FITC+CD45 PE-"                   
## [6] "/rectangle/CD15 FITC-CD45 PE-"                   
## [7] "/rectangle/CD15 FITC-CD45 PE+|CD15 FITC+CD45 PE-"</code></pre>
<p>The gating hierarchy is plotted by:</p>
<div class="sourceCode" id="cb60"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plot-methods.html">plot</a></span><span class="op">(</span><span class="va">gs</span>, bool<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<p><img src="flowWorkspace-Introduction_files/figure-html/plot-gh-1.png" width="700"> Note that Boolean gate is skipped by default and thus needs to be enabled explictily.</p>
<p>Now all the gates are added to the gating tree but the actual data is not gated yet. This is done by calling the <code>recompute</code> method explictily:</p>
<div class="sourceCode" id="cb61"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/recompute.html">recompute</a></span><span class="op">(</span><span class="va">gs</span><span class="op">)</span></code></pre></div>
<p>After gating is finished, gating results can be visualized by the <code>autoplot</code> method:</p>
<div class="sourceCode" id="cb62"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/ggcyto/man/autoplot.html">autoplot</a></span><span class="op">(</span><span class="va">gs</span>,<span class="st">"rectangle"</span><span class="op">)</span> <span class="co">#plot one Gate</span></code></pre></div>
<p><img src="flowWorkspace-Introduction_files/figure-html/autoplot-rect-1.png" width="700"> Multiple gates can be plotted on the same panel:</p>
<div class="sourceCode" id="cb63"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/ggcyto/man/autoplot.html">autoplot</a></span><span class="op">(</span><span class="va">gs</span>, <span class="fu"><a href="../reference/gs_pop_get_parent.html">gs_pop_get_children</a></span><span class="op">(</span><span class="va">gs</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, <span class="st">"rectangle"</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span><span class="op">)</span></code></pre></div>
<p><img src="flowWorkspace-Introduction_files/figure-html/autoplot-multiple-1.png" width="700"> We may also want to plot all the gates without specifying the gate index:</p>
<div class="sourceCode" id="cb64"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/ggcyto/man/autoplot.html">autoplot</a></span><span class="op">(</span><span class="va">gs</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></code></pre></div>
<p><img src="flowWorkspace-Introduction_files/figure-html/autoplot-gh-bool-1.png" width="700"></p>
<p>We can retrieve all the compensation matrices from the <code>GatingHierarchy</code> in case we wish to use the compensation or transformation for the new data,</p>
<div class="sourceCode" id="cb65"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">gh</span> <span class="op">&lt;-</span> <span class="va">gs</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>
<span class="fu"><a href="../reference/gh_get_compensations.html">gh_get_compensations</a></span><span class="op">(</span><span class="va">gh</span><span class="op">)</span>;</code></pre></div>
<pre><code>## Compensation object 'defaultCompensation':
##          FL1-H    FL2-H   FL3-H   FL4-H
## FL1-H 1.000000 0.240000 0.03200 0.00113
## FL2-H 0.007770 1.000000 0.14000 0.00274
## FL3-H 0.008690 0.170000 1.00000 0.21000
## FL4-H 0.000795 0.000995 0.00323 1.00000</code></pre>
<p>Or we can retrieve transformations:</p>
<div class="sourceCode" id="cb67"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">trans</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gh_get_transformations.html">gh_get_transformations</a></span><span class="op">(</span><span class="va">gh</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/flowCore/man/flowFrame-class.html">names</a></span><span class="op">(</span><span class="va">trans</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "FL1-H" "FL2-A" "FL2-H" "FL3-H"</code></pre>
<div class="sourceCode" id="cb69"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">trans</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></code></pre></div>
<pre><code>## function (x) 
## {
##     length * ((asinh(x * sinh(m * log(10))/t) + a * log(10))/((m + 
##         a) * log(10)))
## }
## &lt;bytecode: 0x5581223835b0&gt;
## &lt;environment: 0x558129a59390&gt;
## attr(,"type")
## [1] "fasinh"</code></pre>
<p>If we want to remove one node, simply:</p>
<div class="sourceCode" id="cb71"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/gs_pop_add.html">Rm</a></span><span class="op">(</span><span class="st">'rectangle'</span>, <span class="va">gs</span><span class="op">)</span></code></pre></div>
<pre><code>## Warning: 'Rm' is deprecated.
## Use 'gs_pop_remove' instead.
## See help("Deprecated")</code></pre>
<div class="sourceCode" id="cb73"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/gs_get_pop_paths.html">gs_get_pop_paths</a></span><span class="op">(</span><span class="va">gs</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "root"</code></pre>
<p>As we see, removing one node causes all its descendants to be removed as well.</p>
<div id="archive-and-clone" class="section level3">
<h3 class="hasAnchor">
<a href="#archive-and-clone" class="anchor"></a>Archive and Clone</h3>
<p>Oftentimes, we need to save a <code>GatingSet</code> including the gated flow data, gates, and populations to disk and reload it later on. This can be done by:</p>
<div class="sourceCode" id="cb75"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">tmp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html">tempdir</a></span><span class="op">(</span><span class="op">)</span>
<span class="fu"><a href="../reference/save_gs.html">save_gs</a></span><span class="op">(</span><span class="va">gs</span>,path <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="va">tmp</span>,<span class="st">"my_gs"</span><span class="op">)</span><span class="op">)</span>
<span class="va">gs</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/save_gs.html">load_gs</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="va">tmp</span>,<span class="st">"my_gs"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>We also provide the <code>gs_clone</code> method to make a full copy of an existing <code>GatingSet</code>:</p>
<div class="sourceCode" id="cb76"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">gs1</span> <span class="op">&lt;-</span> <span class="fu">gs_clone</span><span class="op">(</span><span class="va">gs</span><span class="op">)</span></code></pre></div>
<p>To only copy the gates and populations without copy the underlying cyto data.</p>
<div class="sourceCode" id="cb77"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">gs2</span> <span class="op">&lt;-</span> <span class="fu">gs_copy_tree_only</span><span class="op">(</span><span class="va">gs</span><span class="op">)</span></code></pre></div>
<p>This is a lightweight copying which is faster than <code>gs_clone</code>. But be aware the new <code>GatingSet</code> share the same events data (i.e. <code><a href="../reference/gs_cyto_data.html">gs_cyto_data(gs)</a></code>) with the original one.</p>
<p>Note that the <code>GatingSet</code> is a purely reference class with an external pointer that points to the internal ‘C’ data structure. So make sure to use these methods in order to save or make a copy of an existing <code>GatingSet</code> object. The regular R assignment (&lt;-) or <code>save</code> routine doesn’t work as expected for <code>GatingSet</code> objects.</p>
</div>
</div>
<div id="the-cytoframe-and-cytoset-classes" class="section level2">
<h2 class="hasAnchor">
<a href="#the-cytoframe-and-cytoset-classes" class="anchor"></a>The cytoframe and cytoset classes</h2>
<p>The <code>GatingSet</code> class no longer uses <code>flowFrame</code> and <code>flowSet</code> objects for containing the underlying flow data, but rather now uses the analogous <code>cytoframe</code> and <code>cytoset</code> classes. <code>cytoframe</code> and <code>cytoset</code> are essentially reference classes with pointers to internal ‘C’ data structures and thus enable <code>GatingSet</code> operations to be performed more efficiently.</p>
<p>While working with <code>GatingSet</code> objects will often entail working with <code>cytoframe</code> and <code>cytoset</code> objects implicitly, it is also possible to directly work with objects of both of these classes.</p>
<div id="reading-a-cytoframe" class="section level3">
<h3 class="hasAnchor">
<a href="#reading-a-cytoframe" class="anchor"></a>Reading a <code>cytoframe</code>
</h3>
<p>Instead of <code><a href="https://rdrr.io/pkg/flowCore/man/read.FCS.html">read.FCS()</a></code>, <code>cytoframe</code> objects can be created from FCS files with the <code><a href="../reference/load_cytoframe_from_fcs.html">load_cytoframe_from_fcs()</a></code> method. The optional <code>num_threads</code> argument allows for parallelization of the read operation.</p>
<div class="sourceCode" id="cb78"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">files</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html">list.files</a></span><span class="op">(</span><span class="va">dataDir</span>, <span class="st">"Cyto"</span>, full.names <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="va">cf</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/load_cytoframe_from_fcs.html">load_cytoframe_from_fcs</a></span><span class="op">(</span><span class="va">files</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, num_threads <span class="op">=</span> <span class="fl">4</span><span class="op">)</span>
<span class="va">cf</span></code></pre></div>
<pre><code>## cytoframe object 'CytoTrol_CytoTrol_1.fcs'
## with 119531 cells and 12 observables:
##             name         desc     range  minRange  maxRange
## $P1        FSC-A           NA    262143         0    262143
## $P2        FSC-H           NA    262143         0    262143
## $P3        FSC-W           NA    262143         0    262143
## $P4        SSC-A           NA    262143         0    262143
## $P5       B710-A  CD4 PcpCy55    262143      -111    262143
## ...          ...          ...       ...       ...       ...
## $P8       V450-A     CD3 V450    262143      -111    262143
## $P9       V545-A  HLA-DR V500    262143      -111    262143
## $P10      G560-A      CCR7 PE    262143      -111    262143
## $P11      G780-A CD45RA PECy7    262143      -111    262143
## $P12        Time           NA    262143         0    262143
## 199 keywords are stored in the 'description' slot
## row names(0):</code></pre>
<p>Instead of using <code><a href="https://rdrr.io/pkg/flowCore/man/read.FCSheader.html">read.FCSheader()</a></code> to obtain only the header of the file, just use the <code>text.only</code> argument to <code><a href="../reference/load_cytoframe_from_fcs.html">load_cytoframe_from_fcs()</a></code>.</p>
<div class="sourceCode" id="cb80"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">cfh</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/load_cytoframe_from_fcs.html">load_cytoframe_from_fcs</a></span><span class="op">(</span><span class="va">files</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, text.only <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<pre><code>## Warning in parseFCS(normalizePath(filename), list(which.lines = which.lines, :
## text_only is ignored when format is set to 'h5' or 'tile'!</code></pre>
<div class="sourceCode" id="cb82"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">cfh</span></code></pre></div>
<pre><code>## cytoframe object 'CytoTrol_CytoTrol_1.fcs'
## with 119531 cells and 12 observables:
##             name         desc     range  minRange  maxRange
## $P1        FSC-A           NA    262143         0    262143
## $P2        FSC-H           NA    262143         0    262143
## $P3        FSC-W           NA    262143         0    262143
## $P4        SSC-A           NA    262143         0    262143
## $P5       B710-A  CD4 PcpCy55    262143      -111    262143
## ...          ...          ...       ...       ...       ...
## $P8       V450-A     CD3 V450    262143      -111    262143
## $P9       V545-A  HLA-DR V500    262143      -111    262143
## $P10      G560-A      CCR7 PE    262143      -111    262143
## $P11      G780-A CD45RA PECy7    262143      -111    262143
## $P12        Time           NA    262143         0    262143
## 199 keywords are stored in the 'description' slot
## row names(0):</code></pre>
</div>
<div id="cytoframe-accessors" class="section level3">
<h3 class="hasAnchor">
<a href="#cytoframe-accessors" class="anchor"></a><code>cytoframe</code> Accessors</h3>
<p>The accessor methods function the same as they would for a <code>flowFrame</code></p>
<div class="sourceCode" id="cb84"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/flowCore/man/flowFrame-class.html">dim</a></span><span class="op">(</span><span class="va">cf</span><span class="op">)</span></code></pre></div>
<pre><code>##     events parameters 
##     119531         12</code></pre>
<div class="sourceCode" id="cb86"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">cf</span><span class="op">)</span></code></pre></div>
<pre><code>##  [1] "FSC-A"  "FSC-H"  "FSC-W"  "SSC-A"  "B710-A" "R660-A" "R780-A" "V450-A"
##  [9] "V545-A" "G560-A" "G780-A" "Time"</code></pre>
<div class="sourceCode" id="cb88"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/flowCore/man/flowFrame-class.html">exprs</a></span><span class="op">(</span><span class="va">cf</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>##          FSC-A  FSC-H    FSC-W     SSC-A   B710-A   R660-A    R780-A    V450-A
## [1,] 140733.05 133376 69150.98  91113.96 22311.24 35576.07  14302.16 16232.649
## [2,]  26195.32  26207 65506.79  10115.28     5.04   447.93    682.56    43.700
## [3,]  64294.02  51594 81667.89 174620.03   371.28   851.62    -66.36   335.350
## [4,] 128393.87 103613 81210.08 150625.44  1494.36  5672.20   2979.09  1492.450
## [5,] 127717.88 119616 69974.92  76954.91  2545.20  2272.83 124635.93  8608.899
## [6,] 134347.02 125651 70071.60  70116.48 23052.96  1758.54   5281.15  4849.750
##        V545-A   G560-A   G780-A Time
## [1,]  7644.65  4113.60 12672.00  0.2
## [2,]    77.90   -91.20    18.24  0.4
## [3,]   971.85   273.60   271.68  0.6
## [4,] 28790.70   771.84   988.80  0.6
## [5,]  4190.45 14306.88 58977.60  0.7
## [6,]  2859.50  2249.28  1560.96  0.7</code></pre>
<div class="sourceCode" id="cb90"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/flowCore/man/flowFrame-class.html">spillover</a></span><span class="op">(</span><span class="va">cf</span><span class="op">)</span></code></pre></div>
<pre><code>## $SPILL
##            B710-A       R660-A       R780-A       V450-A      V545-A
## [1,] 1.000000e+00 3.143890e-02 0.1909655363 3.057568e-03 0.002047231
## [2,] 5.537983e-03 1.000000e+00 0.1768123886 0.000000e+00 0.000000000
## [3,] 9.958625e-05 9.847661e-03 1.0000000000 0.000000e+00 0.000000000
## [4,] 0.000000e+00 8.909845e-05 0.0000000000 1.000000e+00 0.451194675
## [5,] 2.477092e-03 5.235156e-04 0.0000000000 3.796154e-02 1.000000000
## [6,] 1.172236e-01 1.642721e-03 0.0003321532 0.000000e+00 0.000000000
## [7,] 1.420516e-02 4.568956e-04 0.1754022374 8.902497e-05 0.000000000
##            G560-A      G780-A
## [1,] 3.442413e-04 0.071933810
## [2,] 0.000000e+00 0.006618897
## [3,] 0.000000e+00 0.035399709
## [4,] 1.082746e-04 0.000000000
## [5,] 6.361807e-05 0.000000000
## [6,] 1.000000e+00 0.009219359
## [7,] 4.096870e-02 1.000000000
## 
## $spillover
## NULL
## 
## $`$SPILLOVER`
## NULL</code></pre>
<div class="sourceCode" id="cb92"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="fu"><a href="../reference/keyword.html">keyword</a></span><span class="op">(</span><span class="va">cf</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## $FCSversion
## [1] "3"
## 
## $`$BEGINANALYSIS`
## [1] "0"
## 
## $`$ENDANALYSIS`
## [1] "0"
## 
## $`$BEGINSTEXT`
## [1] "0"
## 
## $`$ENDSTEXT`
## [1] "0"
## 
## $`$BEGINDATA`
## [1] "3264"</code></pre>
</div>
<div id="pass-by-reference" class="section level3">
<h3 class="hasAnchor">
<a href="#pass-by-reference" class="anchor"></a>Pass By Reference</h3>
<p>As <code>cytoframe</code> and <code>cytoset</code> are reference classes, copying objects of either class by the assignment operator (<code><a href="https://rdrr.io/r/base/assignOps.html">&lt;-</a></code>) will simply provide a copy of the external pointer and so changes made to the copy will also affect the original object.</p>
<div class="sourceCode" id="cb94"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">cf1</span> <span class="op">&lt;-</span> <span class="va">cf</span> <span class="co"># cf is a reference</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">cf1</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></code></pre></div>
<pre><code>## [1] "FSC-A"</code></pre>
<div class="sourceCode" id="cb96"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">cf1</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"t"</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">cf</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="co"># The change affects the original cf object</span></code></pre></div>
<pre><code>## [1] "t"</code></pre>
</div>
<div id="views" class="section level3">
<h3 class="hasAnchor">
<a href="#views" class="anchor"></a>Views</h3>
<p>Extracting a subset of a <code>cytoframe</code> is not computationally intensive, as it merely constructs a view of the data of the original <code>cytoframe</code>. However, both objects still share the same underlying pointer to all of the data and thus changes to a view will affect the data of the original <code>cytoframe</code>.</p>
<div class="sourceCode" id="cb98"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">cf1</span> <span class="op">&lt;-</span> <span class="va">cf</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, <span class="fl">2</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span>
<span class="fu"><a href="https://rdrr.io/pkg/flowCore/man/flowFrame-class.html">dim</a></span><span class="op">(</span><span class="va">cf1</span><span class="op">)</span></code></pre></div>
<pre><code>##     events parameters 
##         10          2</code></pre>
<div class="sourceCode" id="cb100"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/flowCore/man/flowFrame-class.html">exprs</a></span><span class="op">(</span><span class="va">cf</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span>,<span class="fl">3</span><span class="op">]</span></code></pre></div>
<pre><code>##    FSC-W 
## 65506.79</code></pre>
<div class="sourceCode" id="cb102"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/flowCore/man/flowFrame-class.html">exprs</a></span><span class="op">(</span><span class="va">cf1</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0</span> <span class="co"># data change affects the orignal cf</span>
<span class="fu"><a href="https://rdrr.io/pkg/flowCore/man/flowFrame-class.html">exprs</a></span><span class="op">(</span><span class="va">cf</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span>,<span class="fl">3</span><span class="op">]</span></code></pre></div>
<pre><code>## FSC-W 
##     0</code></pre>
<p>To construct a new view of an entire <code>cytoframe</code>, use the <code>[]</code> method rather than the <code><a href="https://rdrr.io/r/base/assignOps.html">&lt;-</a></code> operator. This will ensure that a new view is created to the full underlying dataset.</p>
<div class="sourceCode" id="cb104"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">cf1</span> <span class="op">&lt;-</span> <span class="va">cf</span><span class="op">[</span><span class="op">]</span></code></pre></div>
</div>
<div id="deep-copy" class="section level3">
<h3 class="hasAnchor">
<a href="#deep-copy" class="anchor"></a>Deep Copy</h3>
<p>It is also possible to perform a deep copy of a <code>cytoframe</code> or a view of it, resulting in two objects pointing to distinct C-level representations of the data. This is accomplished with the <code>realize_view</code> method.</p>
<div class="sourceCode" id="cb105"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">cf</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/load_cytoframe_from_fcs.html">load_cytoframe_from_fcs</a></span><span class="op">(</span><span class="va">files</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, num_threads <span class="op">=</span> <span class="fl">4</span><span class="op">)</span> <span class="co"># starting fresh</span>
<span class="va">cf1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cytoframe.html">realize_view</a></span><span class="op">(</span><span class="va">cf</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, <span class="fl">2</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/flowCore/man/flowFrame-class.html">dim</a></span><span class="op">(</span><span class="va">cf1</span><span class="op">)</span></code></pre></div>
<pre><code>##     events parameters 
##         10          2</code></pre>
<div class="sourceCode" id="cb107"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/flowCore/man/flowFrame-class.html">exprs</a></span><span class="op">(</span><span class="va">cf</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span>,<span class="fl">3</span><span class="op">]</span></code></pre></div>
<pre><code>##    FSC-W 
## 65506.79</code></pre>
<div class="sourceCode" id="cb109"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/flowCore/man/flowFrame-class.html">exprs</a></span><span class="op">(</span><span class="va">cf1</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0</span> <span class="co"># data change no longer affects the original cf</span>
<span class="fu"><a href="https://rdrr.io/pkg/flowCore/man/flowFrame-class.html">exprs</a></span><span class="op">(</span><span class="va">cf</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span>,<span class="fl">3</span><span class="op">]</span></code></pre></div>
<pre><code>##    FSC-W 
## 65506.79</code></pre>
<div class="sourceCode" id="cb111"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/flowCore/man/flowFrame-class.html">exprs</a></span><span class="op">(</span><span class="va">cf1</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">]</span> <span class="co"># but does affect the separate data of cf1</span></code></pre></div>
<pre><code>## FSC-W 
##     0</code></pre>
<p>Similarly, if a deep copy of all of the data is desired (not a subset), simply call <code>realize_view</code> on the original <code>cytoframe</code>.</p>
</div>
<div id="interconversion-between-cytoframe-and-flowframe" class="section level3">
<h3 class="hasAnchor">
<a href="#interconversion-between-cytoframe-and-flowframe" class="anchor"></a>Interconversion between <code>cytoframe</code> and <code>flowFrame</code>
</h3>
<p>Conversion of objects between the <code>cytoframe</code> and <code>flowFrame</code> classes is accomplished with a few coercion methods</p>
<div class="sourceCode" id="cb113"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">fr</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/convert.html">cytoframe_to_flowFrame</a></span><span class="op">(</span><span class="va">cf</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span><span class="op">(</span><span class="va">fr</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "flowFrame"
## attr(,"package")
## [1] "flowCore"</code></pre>
<div class="sourceCode" id="cb115"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">cf_back</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/convert.html">flowFrame_to_cytoframe</a></span><span class="op">(</span><span class="va">fr</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span><span class="op">(</span><span class="va">cf_back</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "cytoframe"
## attr(,"package")
## [1] "flowWorkspace"</code></pre>
<p>Of course (as a side note), here <code><a href="../reference/convert.html">flowFrame_to_cytoframe()</a></code> had no knowledge of the <code>cytoframe</code> origin of <code>fr</code>, so <code>cf_back</code> points to a new copy of the underlying data.</p>
<div class="sourceCode" id="cb117"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/identical.html">identical</a></span><span class="op">(</span><span class="va">cf</span><span class="op">@</span><span class="va">pointer</span>, <span class="va">cf_back</span><span class="op">@</span><span class="va">pointer</span><span class="op">)</span> <span class="co"># These point to distinct copies of the data</span></code></pre></div>
<pre><code>## [1] FALSE</code></pre>
</div>
<div id="savingloading-a-cytoframe-in-h5" class="section level3">
<h3 class="hasAnchor">
<a href="#savingloading-a-cytoframe-in-h5" class="anchor"></a>Saving/Loading a <code>cytoframe</code> in h5</h3>
<p>A couple of methods handle the task of writing or reading a <code>cytoframe</code> in the HDF5 format on disk</p>
<div class="sourceCode" id="cb119"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">tmpfile</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html">tempfile</a></span><span class="op">(</span>fileext <span class="op">=</span> <span class="st">".h5"</span><span class="op">)</span>
<span class="fu"><a href="../reference/cf_write_h5.html">cf_write_h5</a></span><span class="op">(</span><span class="va">cf</span>, <span class="va">tmpfile</span><span class="op">)</span>
<span class="va">loaded</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/load_cytoframe.html">load_cytoframe</a></span><span class="op">(</span><span class="va">tmpfile</span><span class="op">)</span></code></pre></div>
</div>
<div id="cytoset-methods" class="section level3">
<h3 class="hasAnchor">
<a href="#cytoset-methods" class="anchor"></a><code>cytoset</code> methods</h3>
<p>Most of the above methods for <code>cytoframe</code> objects have <code>cytoset</code> analogs.</p>
<p>For reading in a <code>cytoset</code> from FCS files, use <code>load_cytoset_from_fcs</code></p>
<div class="sourceCode" id="cb120"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">files</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html">list.files</a></span><span class="op">(</span><span class="va">dataDir</span>, <span class="st">"Cyto"</span>, full.names <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="va">cs</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/load_cytoset_from_fcs.html">load_cytoset_from_fcs</a></span><span class="op">(</span><span class="va">files</span>, num_threads <span class="op">=</span> <span class="fl">4</span><span class="op">)</span>
<span class="va">cs</span></code></pre></div>
<pre><code>## A cytoset with 2 samples.
## 
##   column names:
##     FSC-A, FSC-H, FSC-W, SSC-A, B710-A, R660-A, R780-A, V450-A, V545-A, G560-A, G780-A, Time</code></pre>
<p>Once constructed, it can be saved/loaded through more efficient archive format.</p>
<div class="sourceCode" id="cb122"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">tmp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html">tempfile</a></span><span class="op">(</span><span class="op">)</span>
<span class="fu"><a href="../reference/save_cytoset.html">save_cytoset</a></span><span class="op">(</span><span class="va">cs</span>, <span class="va">tmp</span><span class="op">)</span>
<span class="va">cs</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/save_cytoset.html">load_cytoset</a></span><span class="op">(</span><span class="va">tmp</span>, backend_readonly <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<p>note that <code>backend_readonly</code> is set to <code>TRUE</code> by default to protect the data from accidental changes. So it has to be turned off explicitly if your want to modify the loaded <code>cs</code></p>
<p>The accessor methods function the same as they would for a <code>flowSet</code></p>
<div class="sourceCode" id="cb123"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">cs</span><span class="op">)</span></code></pre></div>
<pre><code>##  [1] "FSC-A"  "FSC-H"  "FSC-W"  "SSC-A"  "B710-A" "R660-A" "R780-A" "V450-A"
##  [9] "V545-A" "G560-A" "G780-A" "Time"</code></pre>
<p>Subsetting using <code><a href="../reference/%5B,GatingSet,ANY,ANY,ANY-method.html">[</a></code> will work in a manner similar to that for a <code>flowSet</code>, but will result in another <code>cytoset</code> that is a view in to the data of the original <code>cytoset</code>. The <code><a href="https://rdrr.io/pkg/flowCore/man/Subset-methods.html">Subset()</a></code> method, when called on a <code>cytoset</code>, will also return a <code>cytoset</code> that is a view in to the orignal data rather than a deep copy.</p>
<div class="sourceCode" id="cb125"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">sub_cs</span> <span class="op">&lt;-</span> <span class="va">cs</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></code></pre></div>
<p><strong>Important:</strong> xtraction using <code><a href="../reference/%5B,GatingSet,ANY,ANY,ANY-method.html">[[</a></code> on a <code>cytoset</code> will by default return a <code>cytoframe</code> and so will represent a reference of the underlying data. Thus, altering the result of the extraction <strong>will</strong> alter the underlying data of the original <code>cytoset</code>.</p>
<div class="sourceCode" id="cb126"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">sub_fr</span> <span class="op">&lt;-</span> <span class="va">cs</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>
<span class="fu"><a href="https://rdrr.io/pkg/flowCore/man/flowFrame-class.html">exprs</a></span><span class="op">(</span><span class="va">cs</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">]</span></code></pre></div>
<pre><code>## FSC-H 
## 26207</code></pre>
<div class="sourceCode" id="cb128"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/flowCore/man/flowFrame-class.html">exprs</a></span><span class="op">(</span><span class="va">sub_fr</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0</span> <span class="co"># This WILL affect the original data</span>
<span class="fu"><a href="https://rdrr.io/pkg/flowCore/man/flowFrame-class.html">exprs</a></span><span class="op">(</span><span class="va">cs</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">]</span></code></pre></div>
<pre><code>## FSC-H 
##     0</code></pre>
<p>To return a <code>flowFrame</code> that represents a copy of the data of the <code>original</code> cytoset, you need to use the <code>returnType</code> argument.</p>
<div class="sourceCode" id="cb130"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">sub_cf</span> <span class="op">&lt;-</span> <span class="va">cs</span><span class="op">[[</span><span class="fl">1</span>, returnType <span class="op">=</span> <span class="st">"flowFrame"</span><span class="op">]</span><span class="op">]</span>
<span class="fu"><a href="https://rdrr.io/pkg/flowCore/man/flowFrame-class.html">exprs</a></span><span class="op">(</span><span class="va">cs</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">]</span></code></pre></div>
<pre><code>## FSC-H 
##     0</code></pre>
<div class="sourceCode" id="cb132"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/flowCore/man/flowFrame-class.html">exprs</a></span><span class="op">(</span><span class="va">sub_cf</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">100</span> <span class="co"># This WILL NOT affect the original data</span>
<span class="fu"><a href="https://rdrr.io/pkg/flowCore/man/flowFrame-class.html">exprs</a></span><span class="op">(</span><span class="va">cs</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">]</span></code></pre></div>
<pre><code>## FSC-H 
##     0</code></pre>
<p>Alternatively, if it is easier to remember, <code>get_cytoframe_from_cs</code> will accomplish the same goal</p>
<div class="sourceCode" id="cb134"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">sub_cf</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cytoset.html">get_cytoframe_from_cs</a></span><span class="op">(</span><span class="va">cs</span>,<span class="fl">1</span><span class="op">)</span></code></pre></div>
<p>Finally, the <code>[]</code> and <code><a href="../reference/cytoframe.html">realize_view()</a></code> methods work in a similar manner for <code>cytoset</code> objects as <code>cytoframe</code> objects. <code>[]</code> will return a view in to the original data while <code><a href="../reference/cytoframe.html">realize_view()</a></code> will perform a deep copy.</p>
</div>
</div>
<div id="troubleshooting-and-error-reporting" class="section level2">
<h2 class="hasAnchor">
<a href="#troubleshooting-and-error-reporting" class="anchor"></a>Troubleshooting and error reporting</h2>
<p>If this package is throwing errors when parsing your workspace, contact the package author by emails for post an issue on <a href="https://github.com/RGLab/flowWorkspace/issues" class="uri">https://github.com/RGLab/flowWorkspace/issues</a>. If you can send your workspace by email, we can test, debug, and fix the package so that it works for you. Our goal is to provide a tool that works, and that people find useful.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Greg Finak,Mike Jiang <wjiang2>,Jake Wagner <jpwagner>.</jpwagner></wjiang2></p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
