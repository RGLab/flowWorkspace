<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Create a GatingSet and add/remove the flowCore gate(or population) to/from a GatingHierarchy/GatingSet. — gs_pop_add • flowWorkspace</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Create a GatingSet and add/remove the flowCore gate(or population) to/from a GatingHierarchy/GatingSet. — gs_pop_add" />
<meta property="og:description" content="GatingSet method creates a gatingset from a flowSet with the ungated data as the root node.
add method add the flowCore gate to a GatingHierarchy/GatingSet.
gs_pop_set_gate method update the gate of one population node in GatingHierarchy/GatingSet.
Rm method Remove the population node from a GatingHierarchy/GatingSet. 
They are equivalent to the workFlow,add and Rm methods in flowCore package. 
recompute method does the actual gating after the gate is added,i.e. calculating the event indices according to the gate definition." />
<meta property="og:image" content="/logo.png" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">flowWorkspace</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">4.3.4</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/index.html">Articles</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/RGLab/flowWorkspace">
    <span class="fas fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Create a GatingSet and add/remove the flowCore gate(or population) to/from a GatingHierarchy/GatingSet.</h1>
    
    <div class="hidden name"><code>gs_pop_add.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><code>GatingSet</code> method creates a gatingset from a flowSet with the ungated data as the root node.
<code>add</code> method add the flowCore gate to a GatingHierarchy/GatingSet.
<code>gs_pop_set_gate</code> method update the gate of one population node in GatingHierarchy/GatingSet.
<code>Rm</code> method Remove the population node from a GatingHierarchy/GatingSet. 
They are equivalent to the <code>workFlow</code>,<code>add</code> and <code>Rm</code> methods in <code>flowCore</code> package. 
<code>recompute</code> method does the actual gating after the gate is added,i.e. calculating the event indices according to the gate definition.</p>
    </div>

    <pre class="usage"><span class='fu'>gs_pop_add</span><span class='op'>(</span><span class='va'>gs</span>, <span class='va'>gate</span>, validityCheck <span class='op'>=</span> <span class='cn'>TRUE</span>, <span class='va'>...</span><span class='op'>)</span>

<span class='fu'>gs_pop_remove</span><span class='op'>(</span><span class='va'>gs</span>, <span class='va'>node</span>, <span class='va'>...</span><span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>gs</th>
      <td><p>A <code>GatingSet</code></p></td>
    </tr>
    <tr>
      <th>gate</th>
      <td><p>A <code><a href='https://rdrr.io/pkg/flowCore/man/filter-methods.html'>flowCore::filter</a></code> or a list of <code><a href='https://rdrr.io/pkg/flowCore/man/filter-methods.html'>flowCore::filter</a></code>s or <code>logical</code> vectors to be added to the <code>GatingSet</code>.
when logical vectors, they represent the indices of events to be included in the populations. It can be global that represents
the index to the original full events or local index that is relative to the parent population cell events. See examples for more
details.</p></td>
    </tr>
    <tr>
      <th>validityCheck</th>
      <td><p><code>logical</code> whether to check the consistency of tree structure across samples. default is TRUE. Can be turned off when speed is prefered to the robustness.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>some other arguments to specify how the gates are added to the gating tree.</p><ul>
<li><p>names  a <code>character</code> vector of length four,which specifies the population names resulted by adding a <code>quadGate</code>.The order of the names is clock-wise starting from the top left quadrant population.</p></li>
<li><p>parent a <code>character</code> scalar to specify the parent node name where the new gate to be added to, by default it is NULL,which indicates the root node</p></li>
<li><p>name a <code>character</code> scalar to specify the node name of population that is generated by the gate to be added.</p></li>
<li><p>recompute a <code>logical</code> flag</p></li>
<li><p>negated: a <code>logical</code> scalar to specify whether the gate is negated,which means the the population outside of the gate will be kept as the result population.
      It is FALSE by default.</p></li>
</ul></td>
    </tr>
    <tr>
      <th>node</th>
      <td><p>A <code>character</code> identifies the population node in a <code>GatingHierrarchy</code> or <code>GatingSet</code> to remove</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p><code>GatingSet</code> method returns a <code>GatingSet</code> object with just root node.  
  <code>add</code> method returns a population node ID (or four population node IDs when adding a <code>quadGate</code>) that uniquely identify the population node within a  <code>GatingHierarchy</code>.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='GatingSet-class.html'>GatingSet-class</a></code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='kw'>if</span> <span class='op'>(</span><span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>{</span>
    <span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'>flowCore</span><span class='op'>)</span>
    <span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>GvHD</span><span class='op'>)</span>
<span class='co'>#select raw flow data</span>
    <span class='va'>fs</span><span class='op'>&lt;-</span><span class='va'>GvHD</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>3</span><span class='op'>]</span>
    
<span class='co'>#transform the raw data</span>
    <span class='va'>tf</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/flowCore/man/transformList-class.html'>transformList</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span><span class='op'>(</span><span class='va'>fs</span><span class='op'>[[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>]</span><span class='op'>)</span><span class='op'>[</span><span class='fl'>3</span><span class='op'>:</span><span class='fl'>6</span><span class='op'>]</span>, <span class='va'>asinh</span>, transformationId<span class='op'>=</span><span class='st'>"asinh"</span><span class='op'>)</span>
    <span class='va'>fs_trans</span><span class='op'>&lt;-</span><span class='fu'><a href='transform.html'>transform</a></span><span class='op'>(</span><span class='va'>fs</span>,<span class='va'>tf</span><span class='op'>)</span>
    
<span class='co'>#add transformed data to a gatingset</span>
    <span class='va'>gs</span> <span class='op'>&lt;-</span> <span class='fu'><a href='GatingSet-class.html'>GatingSet</a></span><span class='op'>(</span><span class='va'>fs_trans</span><span class='op'>)</span>
    <span class='va'>gs</span>
    <span class='fu'><a href='gs_get_pop_paths.html'>gs_get_pop_paths</a></span><span class='op'>(</span><span class='va'>gs</span><span class='op'>[[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>]</span><span class='op'>)</span> <span class='co'>#only contains root node</span>
    
<span class='co'>#add one gate</span>
    <span class='va'>rg</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/flowCore/man/rectangleGate-class.html'>rectangleGate</a></span><span class='op'>(</span><span class='st'>"FSC-H"</span><span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>200</span>,<span class='fl'>400</span><span class='op'>)</span>, <span class='st'>"SSC-H"</span><span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>250</span>, <span class='fl'>400</span><span class='op'>)</span>,
        filterId<span class='op'>=</span><span class='st'>"rectangle"</span><span class='op'>)</span>
    
    <span class='va'>nodeID</span><span class='op'>&lt;-</span><span class='fu'>gs_pop_add</span><span class='op'>(</span><span class='va'>gs</span>, <span class='va'>rg</span><span class='op'>)</span><span class='co'>#it is added to root node by default if parent is not specified</span>
    <span class='va'>nodeID</span>
    <span class='fu'><a href='gs_get_pop_paths.html'>gs_get_pop_paths</a></span><span class='op'>(</span><span class='va'>gs</span><span class='op'>[[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>]</span><span class='op'>)</span> <span class='co'>#the second population is named after filterId of the gate </span>
    
<span class='co'>#add a quadGate</span>
    <span class='va'>qg</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/flowCore/man/quadGate-class.html'>quadGate</a></span><span class='op'>(</span><span class='st'>"FL1-H"</span><span class='op'>=</span><span class='fl'>2</span>, <span class='st'>"FL2-H"</span><span class='op'>=</span><span class='fl'>4</span><span class='op'>)</span>
    <span class='va'>nodeIDs</span><span class='op'>&lt;-</span><span class='fu'>gs_pop_add</span><span class='op'>(</span><span class='va'>gs</span>,<span class='va'>qg</span>,parent<span class='op'>=</span><span class='st'>"rectangle"</span><span class='op'>)</span>
    <span class='va'>nodeIDs</span> <span class='co'>#quadGate produces four population nodes</span>
    <span class='fu'><a href='gs_get_pop_paths.html'>gs_get_pop_paths</a></span><span class='op'>(</span><span class='va'>gs</span><span class='op'>[[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>]</span><span class='op'>)</span> <span class='co'>#population names are named after dimensions of gate if not specified</span>
    
<span class='co'>#add a boolean Gate</span>
    <span class='va'>bg</span><span class='op'>&lt;-</span><span class='fu'><a href='booleanFilter-class.html'>booleanFilter</a></span><span class='op'>(</span><span class='va'>`CD15 FITC-CD45 PE+|CD15 FITC+CD45 PE-`</span><span class='op'>)</span>
    <span class='va'>bg</span>
    <span class='va'>nodeID2</span><span class='op'>&lt;-</span><span class='fu'>gs_pop_add</span><span class='op'>(</span><span class='va'>gs</span>,<span class='va'>bg</span>,parent<span class='op'>=</span><span class='st'>"rectangle"</span><span class='op'>)</span>
    <span class='va'>nodeID2</span>
    <span class='fu'><a href='gs_get_pop_paths.html'>gs_get_pop_paths</a></span><span class='op'>(</span><span class='va'>gs</span><span class='op'>[[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>]</span><span class='op'>)</span>
<span class='co'>#do the actual gating</span>
    <span class='fu'><a href='recompute.html'>recompute</a></span><span class='op'>(</span><span class='va'>gs</span><span class='op'>)</span>
    
<span class='co'>#plot one gate for one sample</span>
    <span class='fu'><a href='https://rdrr.io/pkg/ggcyto/man/autoplot.html'>autoplot</a></span><span class='op'>(</span><span class='va'>gs</span><span class='op'>[[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>]</span>,<span class='st'>"rectangle"</span><span class='op'>)</span>
    <span class='fu'><a href='https://rdrr.io/pkg/ggcyto/man/autoplot.html'>autoplot</a></span><span class='op'>(</span><span class='va'>gs</span><span class='op'>[[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>]</span>,<span class='va'>nodeIDs</span><span class='op'>)</span> <span class='co'>#may be smoothed automatically if there are not enough events after gating</span>
    
<span class='co'>#plot gates across samples using lattice plot</span>
    <span class='fu'><a href='https://rdrr.io/pkg/ggcyto/man/autoplot.html'>autoplot</a></span><span class='op'>(</span><span class='va'>gs</span>,<span class='va'>nodeID</span><span class='op'>)</span>
<span class='co'>#plot all gates for one sample</span>
    <span class='fu'><a href='https://rdrr.io/pkg/ggcyto/man/autoplot.html'>autoplot</a></span><span class='op'>(</span><span class='va'>gs</span><span class='op'>[[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>]</span><span class='op'>)</span><span class='co'>#boolean gate is skipped by default </span>
    <span class='fu'><a href='https://rdrr.io/pkg/ggcyto/man/autoplot.html'>autoplot</a></span><span class='op'>(</span><span class='va'>gs</span><span class='op'>[[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>]</span>,bool<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
    
<span class='co'>#plot the gating hierarchy</span>
    <span class='fu'><a href='plot-methods.html'>plot</a></span><span class='op'>(</span><span class='va'>gs</span><span class='op'>[[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>]</span><span class='op'>)</span>
<span class='co'>#remove one node causing the removal of all the descendants </span>
    <span class='fu'>gs_pop_remove</span><span class='op'>(</span><span class='st'>'rectangle'</span>, gs <span class='op'>=</span> <span class='va'>gs</span><span class='op'>)</span>
    <span class='fu'><a href='gs_get_pop_paths.html'>gs_get_pop_paths</a></span><span class='op'>(</span><span class='va'>gs</span><span class='op'>[[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>]</span><span class='op'>)</span>
    
    <span class='co'>#add logical vectors as gate</span>
    <span class='va'>lg</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>sapply</a></span><span class='op'>(</span><span class='fu'><a href='sampleNames.html'>sampleNames</a></span><span class='op'>(</span><span class='va'>gs</span><span class='op'>)</span>, <span class='kw'>function</span><span class='op'>(</span><span class='va'>sn</span><span class='op'>)</span><span class='op'>{</span>
                                   <span class='va'>gh</span> <span class='op'>&lt;-</span> <span class='va'>gs</span><span class='op'>[[</span><span class='va'>sn</span><span class='op'>]</span><span class='op'>]</span>
                                   <span class='va'>dat</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/flowCore/man/flowFrame-class.html'>exprs</a></span><span class='op'>(</span><span class='fu'><a href='gh_pop_get_data.html'>gh_pop_get_data</a></span><span class='op'>(</span><span class='va'>gh</span>, <span class='st'>"cd3+"</span><span class='op'>)</span><span class='op'>)</span><span class='co'>#get events data matrix for this sample at cd3+ node</span>
                                   <span class='va'>vec</span> <span class='op'>&lt;-</span> <span class='va'>dat</span><span class='op'>[</span>, <span class='st'>"FSC-A"</span><span class='op'>]</span> <span class='op'>&gt;</span> <span class='fl'>1e4</span> <span class='op'>&amp;</span> <span class='va'>data</span><span class='op'>[</span>, <span class='st'>"SSC-A"</span><span class='op'>]</span> <span class='op'>&gt;</span> <span class='fl'>1e5</span>
                                   <span class='va'>vec</span>
                                   <span class='op'>}</span><span class='op'>)</span>
   <span class='fu'>gs_pop_add</span><span class='op'>(</span><span class='va'>gs</span>, <span class='va'>lg</span>, name <span class='op'>=</span> <span class='st'>"new_bool"</span>, parent <span class='op'>=</span> <span class='st'>"cd3+"</span><span class='op'>)</span>
 <span class='op'>}</span>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Greg Finak,Mike Jiang <wjiang2@fhcrc.org>,Jake Wagner <jpwagner@fhcrc.org>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


